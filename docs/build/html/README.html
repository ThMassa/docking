<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Readme File &mdash; Guerledocking 1.0 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/copybutton.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
        <script src="_static/clipboard.min.js"></script>
        <script src="_static/copybutton.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Welcome to Guerledocking&#8217;s documentation!" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            Guerledocking
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Readme File</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#docking-autonome">Docking autonome</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#auteurs">Auteurs</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#table-of-contents">Table of Contents</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#description">Description</a></li>
<li class="toctree-l3"><a class="reference internal" href="#documentation">Documentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#configuration">Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="#requirements">Requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="#usage">Usage</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#packages">Packages</a></li>
<li class="toctree-l4"><a class="reference internal" href="#dock">Dock</a></li>
<li class="toctree-l4"><a class="reference internal" href="#boat">Boat</a></li>
<li class="toctree-l4"><a class="reference internal" href="#rtk-base">RTK Base</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#utiliser-docker-pour-ne-pas-avoir-a-installer-ros">Utiliser Docker pour ne pas avoir √† installer ROS</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Guerledocking</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Readme File</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/README.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="readme-file">
<h1>Readme File<a class="headerlink" href="#readme-file" title="Permalink to this heading">&#61633;</a></h1>
<meta charset="latin-1">
<section id="docking-autonome">
<h2>Docking autonome<a class="headerlink" href="#docking-autonome" title="Permalink to this heading">&#61633;</a></h2>
<section id="auteurs">
<h3>Auteurs<a class="headerlink" href="#auteurs" title="Permalink to this heading">&#61633;</a></h3>
<ul class="simple">
<li><p>GARDE Guillaume (Promotion <a class="reference external" href="https://www.ensta-bretagne.fr"><em>ENSTA Bretagne</em></a> 2024 - Sp√©cialit√© Robotique Autonome).</p></li>
<li><p>MASSA Th√©o (Promotion <a class="reference external" href="https://www.ensta-bretagne.fr"><em>ENSTA Bretagne</em></a> 2024 - Sp√©cialit√© Robotique Autonome).</p></li>
<li><p>HOFMANN Hugo (Promotion <a class="reference external" href="https://www.ensta-bretagne.fr"><em>ENSTA Bretagne</em></a> 2024 - Sp√©cialit√© Robotique Autonome).</p></li>
<li><p>REN K√©vin (Promotion <a class="reference external" href="https://www.ensta-bretagne.fr"><em>ENSTA Bretagne</em></a> 2024 - Sp√©cialit√© Robotique Autonome).</p></li>
</ul>
</section>
</section>
<section id="table-of-contents">
<h2>Table of Contents<a class="headerlink" href="#table-of-contents" title="Permalink to this heading">&#61633;</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="#docking-autonome">Docking autonome</a></p>
<ul>
<li><p><a class="reference external" href="#auteurs">Auteurs</a></p></li>
</ul>
</li>
<li><p><a class="reference external" href="#table-of-contents">Table of Contents</a></p>
<ul>
<li><p><a class="reference external" href="#description">Description</a></p></li>
<li><p><a class="reference external" href="#documentation">Documentation</a></p></li>
<li><p><a class="reference external" href="#configuration">Configuration</a></p></li>
<li><p><a class="reference external" href="#requirements">Requirements</a></p></li>
<li><p><a class="reference external" href="#usage">Usage</a></p>
<ul>
<li><p><a class="reference external" href="#packages">Packages</a></p></li>
<li><p><a class="reference external" href="#dock">Dock</a></p></li>
<li><p><a class="reference external" href="#boat">Boat</a></p></li>
<li><p><a class="reference external" href="#rtk-base">RTK Base</a></p></li>
</ul>
</li>
<li><p><a class="reference external" href="#utiliser-docker-pour-ne-pas-avoir-√†-installer-ros">Utiliser Docker</a></p></li>
</ul>
</li>
</ul>
<section id="description">
<h3>Description<a class="headerlink" href="#description" title="Permalink to this heading">&#61633;</a></h3>
<p>Le but du projet est d&#8217;automatiser le processus de docking d&#8217;un drone. Pour cela on doit cr√©er un dock capable d&#8217;envoyer sa position GPS et son orientation au drone qui, √† partir de ces informations, sera capable de calculer une trajectoire et d&#8217;adopter un comportement lui permettant de se docker automatiquement. En plus de cela, il est n√©cessaire de mettre en place une balise RTK permettant d&#8217;obtenir une pr√©cision GPS au centim√®tre.</p>
</section>
<section id="documentation">
<h3>Documentation<a class="headerlink" href="#documentation" title="Permalink to this heading">&#61633;</a></h3>
<!-- TODO -->
<p>La doc pour la centrale inertielle SBG peut se trouver <a class="reference external" href="https://github.com/SBG-Systems/sbg_ros_driver">ici</a></p>
<p>La doc pour le driver GPS sur le dock peut se trouver <a class="reference external" href="https://github.com/KumarRobotics/ublox">ici</a></p>
</section>
<section id="configuration">
<h3>Configuration<a class="headerlink" href="#configuration" title="Permalink to this heading">&#61633;</a></h3>
<p>Toutes les cartes √©tant sur une installation ubuntu18.04 (ou √©quivalent), l&#8217;ensemble de notre architecture repose sur <a class="reference external" href="http://wiki.ros.org/melodic">ROS Melodic</a>.</p>
</section>
<section id="requirements">
<h3>Requirements<a class="headerlink" href="#requirements" title="Permalink to this heading">&#61633;</a></h3>
<!-- TODO -->
</section>
<section id="usage">
<h3>Usage<a class="headerlink" href="#usage" title="Permalink to this heading">&#61633;</a></h3>
<section id="packages">
<h4>Packages<a class="headerlink" href="#packages" title="Permalink to this heading">&#61633;</a></h4>
<p>Pour des raisons pratiques de d√©pendances ROS diff√©rentes (et de capteurs diff√©rents) selon qu&#8217;on soit sur le dock, le drone ou le rover, il a √©t√© d√©cid√© de s√©parer chaque partie en un package ROS diff√©rent.</p>
<p>Sur le dock, le package <em>guerledocking</em> sera utilis√©, sur le drone ce sera <em>guerleboat</em> et sur le rover <em>guerlerover</em>. Il est important de noter qu&#8217;√† priori il est impossible de build les packages sur autre chose que l&#8217;objet d√©di√© car les d√©pendances ROS sont sp√©cifiques comme pr√©cis√© pr√©c√©demment.</p>
</section>
<section id="dock">
<h4>Dock<a class="headerlink" href="#dock" title="Permalink to this heading">&#61633;</a></h4>
<p>Pour utiliser le dock, il suffit de se connecter sur le m√™me r√©seau (pour l&#8217;instant via les modem SIMPULSE) et de se connecter en ssh:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>ssh nvidia@192.168.0.12
# MDP : nvidia
</pre></div>
</div>
<p>Une fois connect√© en ssh, il suffit de lancer notre <a class="reference internal" href="#/catkin_ws/src/guerledocking/launch/launch_dock.launch"><span class="xref myst">roslaunch</span></a> :</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>roslaunch guerledock launch_dock.launch
</pre></div>
</div>
<p>Cette commande lance notre <a class="reference internal" href="#/catkin_ws/src/guerledocking/scripts/node_data_broadcaster.py"><span class="xref myst">node ROS</span></a> ainsi que les drivers du GPS et de la centrale inertielle. Les donn√©es GPS et inertielle du dock sont ensuite communiqu√©es via connection UDP au device connect√© √† l&#8217;autre modem. Il y a √©galement une prise de logs de toutes les donn√©es GPS et inertielles qui peuvent √™tre utiles √† des fins d&#8217;analyse.</p>
<p>Pour mettre √† jour le package il faut faire:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>scp -r catkin_ws/src/guerledocking nvidia@192.168.0.12:~/catkin_ws/src/
</pre></div>
</div>
<p>Puis dans le ssh :</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>cd catkin_ws
catkin_make
</pre></div>
</div>
</section>
<section id="boat">
<h4>Boat<a class="headerlink" href="#boat" title="Permalink to this heading">&#61633;</a></h4>
<p>Pour utiliser le bateau, plusieurs options s&#8217;offrent √† nous, principalement pour se connecter dessus. Il est possible de :</p>
<ul class="simple">
<li><p>Se connecter sur le wifi local :  M1800_11_SR / MDP: Texys2018</p></li>
<li><p>Se connecter en utilisant la base station : APN_Drone_11 / MDP: IMSolutions2020</p></li>
<li><p>Brancher un dangle WiFi pour √™tre sur le m√™me r√©seau externe.</p></li>
</ul>
<p>Ensuite il suffit de se ssh :</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>ssh surcouf@192.168.105.80 # Si wifi local (p-e v√©rifier adresse IP)

ssh surcouf@10.0.11.100 # Si base station
</pre></div>
</div>
<p>Dans tous les cas le mot de passe est : <em><strong>surcouf2023</strong></em></p>
<p>Une fois connect√©, il faut lancer le <a class="reference internal" href="#/catkin_ws/src/guerleboat/launch/launch_boat.launch"><span class="xref myst">roslaunch</span></a>.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>roslaunch guerleboat launch_boat.launch
</pre></div>
</div>
<p>Cependant cela n&#8217;est pas suffisant. Il faut armer le syst√®me mavlink et le mettre en mode <em>GUIDED</em>. Pour cela il suffit de faire sur un autre terminal:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>rosrun mavros mavsafety arm
rosrun mavros mavsys mode -c GUIDED
</pre></div>
</div>
<p>Pour mettre √† jour le package il faut faire:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>scp -r catkin_ws/src/guerleboat surcouf@10.0.11.100:~/catkin_ws/src/
</pre></div>
</div>
<p>Puis dans le ssh :</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>cd catkin_ws
catkin_make
</pre></div>
</div>
</section>
<section id="rtk-base">
<h4>RTK Base<a class="headerlink" href="#rtk-base" title="Permalink to this heading">&#61633;</a></h4>
<p>Pour installer la base RTK, il suffit de</p>
<ul class="simple">
<li><p>connecter le module Ardusimple+Xbee √† la Raspberry en faisant attention √† bien brancher sur le port &#8220;Power+GPS&#8221; et non pas sur le port &#8220;Power+XBEE&#8221;.</p></li>
<li><p>relier la carte Ardusimple √† l&#8217;antenne RTK √† l&#8217;aide du c√¢ble coaxial de l&#8217;installation.</p></li>
<li><p>alimenter la Raspberry et attendre 2-3 minutes que le module se lance correctement (on peut connecter la Raspberry √† un √©cran pour en avoir le coeur net).</p></li>
</ul>
<p>Normalement, l&#8217;acquisition se lance toute seule. Attention, pour obtenir une pr√©cision centim√©trique, il faut que la base enregistre ses donn√©es pendant 24h. Les archivages se lancent √† 4h du matin tous les jours donc il faut bien prendre en compte ce param√®tre pour avoir un log de 24h complet. Il faut ensuite suivre les <a class="reference external" href="https://docs.centipede.fr/docs/base/positionnement.html">instructions</a> donn√©es par Centip√®de pour communiquer avec IGN.</p>
<p>Si on veut ind√©pendament v√©rifier les donn√©es GPS, on peut le faire (sous linux) en connectant le module Ardusimple en USB et en suivant ce <a class="reference external" href="https://www.ardusimple.com/how-to-use-ardusimple-rtk-receivers-and-get-gps-data-in-ros/">tuto</a>. Sinon, on peut connecter le module Ardusimple en USB (sous Windows) suivre la section 7 des <a class="reference external" href="https://docs.centipede.fr/docs/base/Installation.html">indications</a> donn√©es par Centip√®de. L&#8217;adresse http://basegnss.local permet d&#8217;acc√©der aux logs (sous Windows) de la base et le mot de passe est <em>admin</em>. On peut alors entre autre t√©l√©charger les fichiers qui nous int√©ressent. Autrement, il est possible de se connecter en ssh √† la carte Raspberry, lorsque le module Ardusimple y est reli√©, en tapant :</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>    ssh basegnss@basegnss.local
    # mot de passe : basegnss!
</pre></div>
</div>
<p>Ceci permet d&#8217;acc√©der aux informations de la carte et √©ventuellement de d√©bugger.</p>
</section>
</section>
<section id="utiliser-docker-pour-ne-pas-avoir-a-installer-ros">
<h3>Utiliser Docker pour ne pas avoir √† installer ROS<a class="headerlink" href="#utiliser-docker-pour-ne-pas-avoir-a-installer-ros" title="Permalink to this heading">&#61633;</a></h3>
<p>Dans le dossier Docker de ce projet, on peut trouver un Dockerfile permettant de construire une image avec Ubuntu 18.04 et ROS Melodic. Une archive donne aussi la version avec Ubuntu 20.04 et ROS Noetic. Pour contruire l&#8217;image Docker, il faut se rendre dans le dossier <em>/Docker</em> puis taper :</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>    docker built -t name . # remplacer &quot;name&quot;
    # par le nom voulu pour l&#39;image
</pre></div>
</div>
<p>Il faut ensuite attendre quelques minutes la cr√©ation de l&#8217;image. Pour lancer le conteneur, il est important de pr√©ciser en commande les autorisations souhait√©es et les fichiers partag√©s :</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>    docker run -it --privileged -v  &quot;to_share&quot;:&quot;destination&quot; --rm &quot;name&quot;:latest
</pre></div>
</div>
<p>avec &#8220;name&#8221; le nom de l&#8217;image cr√©√©e.</p>
<p>Pour autoriser le conteneur √† afficher des fen√™tres graphiques, il faut rajouter la commande suivante apr√®s &#8220;privileged&#8221; :</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>    -e DISPLAY=$DISPLAY
</pre></div>
</div>
<p>et derri√®re le &#8220;-v&#8221; :</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>    /tmp/.X11-unix:/tmp/.X11-unix
</pre></div>
</div>
<p>Ce qui donne :</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>    docker run -it --privileged -e DISPLAY=$DISPLAY -v /tmp/.X11-unix:/tmp/.X11-unix &quot;to_share&quot;:&quot;destination&quot; --rm &quot;name&quot;:latest
</pre></div>
</div>
<p>En cas de refus de la part de l&#8217;h√¥te, on rajoute :</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>    xhost +
</pre></div>
</div>
<p>avant de lancer le conteneur. Mais cette commande est √† √©viter si possible pour des raisons de s√©curit√© pour l&#8217;h√¥te.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="Welcome to Guerledocking&#8217;s documentation!" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, KÈvin REN, ThÈo MASSA, Guillaume GARDE, Hugo HOFMANN.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>